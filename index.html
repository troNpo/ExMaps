<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ExMaps</title>
  <!--manifest.json-->
<link rel="manifest" href="manifest.json" />
  <!-- Estilos -->
  <link rel="stylesheet" href="style.css" />

  <!-- Leaflet para mapas -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <!-- Geocoder plugin para Nominatim -->
<link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
<script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
</head>
<body>
    
    <!-- botÃ³n menÃº flotante -->
        <button id="toggleBotonera" class="toggle-botonera" title="Mostrar/Ocultar barra">
  <img src="icons/ui/fi-sr-brain-circuit.svg" alt="Toggle" />
</button>
    
    <!-- botonera lateral  -->
  <div id="barraControles" class="barra-lateral">
  <!-- ğŸ“ Buscar lugar (Nominatim) -->
  <div class="bloque-boton">
    <button id="btnBuscarLugar" title="Buscar lugar" class="btnLateral">
      <img src="icons/ui/fi-sr-land-location.svg" alt="Buscar lugar" />
    </button>
    <span>UbicaciÃ³n</span>
  </div>
  <!-- capas -->
<div class="bloque-boton">
  <button id="btnPanelCapas" class="btnLateral" title="Capas del mapa">
    <img src="icons/ui/fi-sr-layers.svg" alt="Capas">
  </button>
  <span>Capas</span>
</div>

  <!-- â• Zoom in  -->
  <div class="bloque-boton">
    <button id="btnZoomIn" title="Acercar mapa" class="btnLateral">
      <img src="icons/ui/fi-sr-zoom-in.svg" alt="Zoom +" />
    </button>
     <span>zoom</span>
  </div>
 

  <!-- â– Zoom out  -->
  <div class="bloque-boton">
    <button id="btnZoomOut" title="Alejar mapa" class="btnLateral">
      <img src="icons/ui/fi-sr-zoom-out.svg" alt="Zoom -" />
    </button>
  </div>

  <!-- ğŸ” CategorÃ­as -->
  <div class="bloque-boton">
    <button id="menuBtn" title="Abrir panel" class="btnLateral">
      <img src="icons/ui/fi-sr-category.svg" alt="MenÃº" />
    </button>
    <span>CategorÃ­as</span>
  </div>

  
  <!-- ğŸ”„ Actualizar bÃºsqueda -->
  <div class="bloque-boton">
    <button id="btnBusquedaDirecta" title="Buscar desde mapa" class="btnLateral">
      <img src="icons/ui/fi-sr-search-location.svg" alt="Buscar desde mapa" />
    </button>
    <span>Actualizar</span>
  </div>
  
  <!--  BotÃ³n Limpiar mapa -->
<div class="bloque-boton">
  <button title="Limpiar mapa" class="btnLateral" onclick="limpiarMapa()">
    <img src="icons/ui/fi-sr-eraser.svg" alt="Limpiar mapa" />
  </button>
  <span>Limpiar</span>
</div>

<!-- ajustes  -->
<div class="bloque-boton">
  <button id="btnAjustesMapa" title="Ajustes del mapa" class="btnLateral">
    <img src="icons/ui/fi-sr-square-ellipsis.svg" alt="Ajustes" />
  </button>
  <span>Opciones</span>
</div>
<!-- â” BotÃ³n de ayuda -->
<div class="bloque-boton">
  <button id="btnAyudaMapa" title="Abrir ayuda" class="btnLateral" onclick="abrirAyuda()">
    <img src="icons/ui/fi-sr-question-square.svg" alt="Ayuda sobre la app" />
  </button>
  <span>Ayuda</span>
</div>
</div>

<!-- MenÃº emergente que se abre al pulsar el botÃ³n de ajustes -->
<div id="menuAjustes" class="menu-emergente">

  <button class="cerrarMenu" onclick="cerrarAjustes()">
    <img src="icons/ui/fi-sr-cross-small.svg" alt="Cerrar ajustes" />
  </button>

  <!-- SecciÃ³n de usuario -->
  <button onclick="abrirPerfilUsuario()" class="btn-opcion">
    <img src="icons/ui/fi-sr-user-gear.svg" alt="Perfil de usuario" />
    Perfil de usuario
  </button>
  
  <!-- ğŸ§­ ExportaciÃ³n directa KML -->
  <button onclick="exportarMapaKML(construirPoisPorCategoria())" class="btn-opcion">
    <img src="icons/ui/fi-sr-folder-download.svg" alt="Exportar mapa KML" />
    Exportar todos los POIs del mapa
  </button>

  <button onclick="exportarPOIsSeleccionados()" class="btn-opcion">
    <img src="icons/ui/fi-sr-file-download.svg" alt="Exportar seleccionados KML" />
    Exportar Capa personalizada 
  </button>
<!-- SecciÃ³n avanzada -->
  <button onclick="abrirConfiguracionAvanzada()" class="btn-opcion">
    <img src="icons/ui/fi-sr-settings.svg" alt="ConfiguraciÃ³n avanzada" />
    Con.avanzada
  </button>
</div>

<!-- Panel bÃºsqueda Nominatim -->
<div id="panelResultadosNominatim" class="menu-emergente" >
  
  <!-- âŒ BotÃ³n cerrar -->
  <button class="btnVolverPanel" onclick="cerrarPanelResultados()">
    <img src="icons/ui/fi-sr-cross-small.svg" alt="Cerrar panel" />
  </button>

  <!-- ğŸ§­ TÃ­tulo de bÃºsqueda -->
  <label>
    <img src="icons/ui/fi-sr-land-location.svg" alt="Icono ubicaciÃ³n" />
    Buscar ubicaciÃ³n
  </label>

  <!-- ğŸ” Barra de bÃºsqueda -->
  <div class="busqueda-wrap">
    <input type="text" id="inputDireccion" placeholder="ğŸ“ Escribe una direcciÃ³n..." />
    <button id="btnBuscarDireccion">Buscar</button>
  </div>

  <!-- ğŸ“‹ TÃ­tulo de resultados -->
  <label>
    <img src="icons/ui/fi-sr-list.svg" alt="Icono lista" />
    Resultados
  </label>

  <!-- ğŸ“ Ãrea de resultados -->
  <div id="resultadosNominatim"></div>
</div>    

<!-- Panel flotante para el perfil de usuario -->
<div id="menuPerfilUsuario" class="menu-emergente">
 <button class="btnVolverPanel cerrarMenu" onclick="cerrarPerfilUsuario()">
  <img src="icons/ui/fi-sr-cross-small.svg" alt="Cerrar panel" />
</button>

  <h3>Preferencias</h3>

  <div class="bloque-config">
    <label for="ubicacionDefecto">
      <img src="icons/ui/fi-sr-home-location-alt.svg" alt="UbicaciÃ³n" />
      UbicaciÃ³n por defecto
    </label>
    <input type="text" id="ubicacionDefecto" placeholder="Ej. Sevilla, EspaÃ±a" />
    <button onclick="buscarUbicacion()">Buscar ubicaciÃ³n</button>
    <small id="ubicacionConfirmada"></small>
  </div>

  <div class="bloque-config">
    <label for="modoUso">
      <img src="icons/ui/fi-sr-mobile-hand.svg" alt="Modo de uso" />
      Modo de uso
    </label>
    <select id="modoUso">
      <option value="diestro">Diestro</option>
      <option value="zurdo">Zurdo</option>
    </select>
  </div>

  <button onclick="guardarPreferenciasUsuario()">âœ… Guardar preferencias</button>
</div>


  <!-- ğŸ“‚ Panel lateral -->
  <div id="sidebar" class="sidebar hidden">
    <div id="logoExMaps">
  <img src="icons/logo512.png" alt="Logo ExMaps" />
</div>  
    <!-- ğŸ·ï¸ TÃ­tulo de la app -->
    <div id="nombreApp">Puntos de InterÃ©s</div> 
    
    <!-- ğŸ§­ Panel principal de selecciÃ³n de categorÃ­as -->
 <div id="panelCategorias" class="subpanel visible">
  <button class="btnVolverPanel soloIcono" onclick="cerrarPanelCategorias()">
    <img src="icons/ui/fi-sr-arrow-small-left.svg" alt="Cerrar panel">
  </button>
  <h2>Explorar categorÃ­as</h2>
  <button class="btnBuscarPanel">ğŸ” Buscar seleccionados</button>
  <button id="btnLimpiarSeleccion" class="btnSecundario">
  ğŸ§¹ Limpiar selecciÃ³n
</button>
  
  <div class="grupo-categorias">
    <button onclick="mostrarCategoria('ciclismo_senderismo')">ğŸš¶ Ciclismo y senderismo</button>
    <button onclick="mostrarCategoria('alojamiento')">ğŸ›ï¸ Alojamiento</button>
    <button onclick="mostrarCategoria('comodidades')">ğŸš¿ Comodidades</button>
    <button onclick="mostrarCategoria('emergencias')">ğŸš¨ Emergencias</button>
    <button onclick="mostrarCategoria('naturaleza')">ğŸŒ¿ Naturaleza</button>
    <button onclick="mostrarCategoria('ocio_turismo')">ğŸ­ Ocio y turismo</button>
    <button onclick="mostrarCategoria('servicios')">ğŸ› ï¸ Servicios</button>
    <button onclick="mostrarCategoria('transporte')">ğŸš‰ Transporte</button>
  </div>
</div>
<div id="panelalojamiento" class="subpanel hidden">
  <button class="btnVolverPanel soloIcono" onclick="volverCategorias()">
    <img src="icons/ui/fi-sr-arrow-small-left.svg" alt="Volver">
  </button>
  <h2>ğŸ›ï¸ Alojamiento</h2>
   <button class="btnBuscarPanel" id="btnBuscarAlojamiento">ğŸ” Buscar POIs</button>
  <div class="contenedorFiltros">
    <label>
      <input type="checkbox" class="poicheck" data-cat="tourism" data-sub="alpine_hut">
      Refugio de montaÃ±a
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="tourism" data-sub="wilderness_hut">
      Refugio bÃ¡sico
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="tourism" data-sub="camp_site">
      Camping
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="tourism" data-sub="caravan_site">
      Caravanas
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="tourism" data-sub="hostel">
      Albergue / Hostel
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="tourism" data-sub="guest_house">
      Casa de huÃ©spedes
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="tourism" data-sub="hotel">
      Hotel
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="tourism" data-sub="chalet">
      Chalet
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="tourism" data-sub="apartment">
      Apartamento turÃ­stico
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="tourism" data-sub="motel">
      Motel
    </label>
  </div>
</div>
  <div id="panelciclismo_senderismo" class="subpanel hidden">
  <button class="btnVolverPanel soloIcono" onclick="volverCategorias()">
    <img src="icons/ui/fi-sr-arrow-small-left.svg" alt="Volver">
  </button>
  <h2>ğŸš¶ Ciclismo y senderismo</h2>
   <button class="btnBuscarPanel" id="btnBuscarRutaActiva">ğŸ” Buscar POIs</button>
  <div class="contenedorFiltros">
    <label>
      <input type="checkbox" class="poicheck" data-cat="information" data-sub="guidepost">
      Poste de ruta
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="information" data-sub="trailhead">
      Inicio de ruta
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="amenity" data-sub="bicycle_repair_station">
      ReparaciÃ³n bici
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="amenity" data-sub="charging_station">
      Punto de carga
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="tourism" data-sub="picnic_site">
      Zona picnic
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="amenity" data-sub="firepit">
      Zona fuego
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="amenity" data-sub="shelter">
      Refugio sencillo
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="information" data-sub="guidepost">
      SeÃ±al guÃ­a
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="information" data-sub="board">
      Panel informativo
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="information" data-sub="terminal">
      Terminal digital
    </label>
  </div>
</div>

<div id="panelcomodidades" class="subpanel hidden">
  <button class="btnVolverPanel soloIcono" onclick="volverCategorias()">
    <img src="icons/ui/fi-sr-arrow-small-left.svg" alt="Volver">
  </button>
  <h2>ğŸš¿ Comodidades</h2>
  <button class="btnBuscarPanel" id="btnBuscarComodidades">ğŸ” Buscar POIs</button>
  <div class="contenedorFiltros">
    <label>
      <input type="checkbox" class="poicheck" data-cat="amenity" data-sub="drinking_water">
      Agua potable
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="amenity" data-sub="toilets">
      Aseos pÃºblicos
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="amenity" data-sub="bench">
      Banco
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="amenity" data-sub="lounger">
      Tumbona
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="amenity" data-sub="fountain">
      Fuente
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="amenity" data-sub="recycling">
      Punto reciclaje
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="amenity" data-sub="shelter">
      Refugio cÃ³modo
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="amenity" data-sub="public_bath">
      BaÃ±o pÃºblico / termal
    </label>
  </div>
</div>

<div id="panelemergencias" class="subpanel hidden">
  <button class="btnVolverPanel soloIcono" onclick="volverCategorias()">
    <img src="icons/ui/fi-sr-arrow-small-left.svg" alt="Volver">
  </button>
  <h2>ğŸš¨ Emergencias</h2>
    <button class="btnBuscarPanel" id="btnBuscarEmergencias">ğŸ” Buscar POIs</button>
  <div class="contenedorFiltros">
    <label>
      <input type="checkbox" class="poicheck" data-cat="amenity" data-sub="hospital">
      Hospital
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="amenity" data-sub="pharmacy">
      Farmacia
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="amenity" data-sub="doctors">
      Centro mÃ©dico / doctor
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="emergency" data-sub="emergency_phone">
      TelÃ©fono de emergencia
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="emergency" data-sub="emergency_access_point">
      Punto de acceso mÃ©dico
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="emergency" data-sub="defibrillator">
      Desfibrilador
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="amenity" data-sub="police">
      PolicÃ­a
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="amenity" data-sub="fire_station">
      Bomberos
    </label>
  </div>
</div>

<div id="panelnaturaleza" class="subpanel hidden">
  <button class="btnVolverPanel soloIcono" onclick="volverCategorias()">
    <img src="icons/ui/fi-sr-arrow-small-left.svg" alt="Volver">
  </button>
  <h2>ğŸŒ¿ Naturaleza</h2>
  <button class="btnBuscarPanel" id="btnBuscarNaturaleza">ğŸ” Buscar POIs</button>
  <div class="contenedorFiltros">
    <label>
      <input type="checkbox" class="poicheck" data-cat="natural" data-sub="tree">
      Ãrbol destacado
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="natural" data-sub="spring">
      Manantial
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="natural" data-sub="waterfall">
      Cascada
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="natural" data-sub="cave_entrance">
      Cueva
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="natural" data-sub="rock">
      FormaciÃ³n rocosa
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="natural" data-sub="cliff">
      Acantilado
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="natural" data-sub="volcano">
      VolcÃ¡n
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="natural" data-sub="peak">
      Pico
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="natural" data-sub="saddle">
      Collado
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="natural" data-sub="mountain_pass">
      Paso montaÃ±oso
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="tourism" data-sub="viewpoint">
      Mirador
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="boundary" data-sub="protected_area">
      Ãrea protegida
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="leisure" data-sub="botanical_garden">
      JardÃ­n botÃ¡nico
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="natural" data-sub="beach">
      Playa
    </label>
    <label>
      <input type="checkbox" class="poicheck" data-cat="leisure" data-sub="park">
      Parque
    </label>
  </div>
</div>

<div id="panelocio_turismo" class="subpanel hidden">
  <button class="btnVolverPanel soloIcono" onclick="volverCategorias()">
    <img src="icons/ui/fi-sr-arrow-small-left.svg" alt="Volver">
  </button>
  <h2>ğŸ­ Ocio y turismo</h2>
   <button class="btnBuscarPanel" id="btnBuscarOcioTurismo">ğŸ” Buscar POIs</button>
  <div class="contenedorFiltros">
    <label><input type="checkbox" class="poicheck" data-cat="tourism" data-sub="museum"> Museo</label>
    <label><input type="checkbox" class="poicheck" data-cat="tourism" data-sub="gallery"> GalerÃ­a de arte</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="cinema"> Cine</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="theatre"> Teatro</label>
    <label><input type="checkbox" class="poicheck" data-cat="historic" data-sub="castle"> Castillo</label>
    <label><input type="checkbox" class="poicheck" data-cat="historic" data-sub="ruins"> Ruinas</label>
    <label><input type="checkbox" class="poicheck" data-cat="historic" data-sub="monument"> Monumento</label>
    <label><input type="checkbox" class="poicheck" data-cat="historic" data-sub="memorial"> Memorial</label>
    <label><input type="checkbox" class="poicheck" data-cat="tourism" data-sub="artwork"> Arte pÃºblico</label>
    <label><input type="checkbox" class="poicheck" data-cat="tourism" data-sub="sculpture"> Escultura</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="library"> Biblioteca</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="public_bookcase"> EstanterÃ­a pÃºblica</label>
    <label><input type="checkbox" class="poicheck" data-cat="tourism" data-sub="zoo"> ZoolÃ³gico</label>
    <label><input type="checkbox" class="poicheck" data-cat="tourism" data-sub="attraction"> AtracciÃ³n turÃ­stica</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="wayside_shrine"> Altar</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="wayside_cross"> Cruz histÃ³rica</label>
    <label><input type="checkbox" class="poicheck" data-cat="historic" data-sub="archaeological_site"> Sitio arqueolÃ³gico</label>

    <!-- ğŸ½ï¸ Experiencia culinaria -->
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="restaurant"> Restaurante</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="fast_food"> Comida rÃ¡pida</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="cafe"> CafeterÃ­a</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="bar"> Bar</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="pub"> Pub / cervecerÃ­a</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="biergarten"> Biergarten</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="ice_cream"> HeladerÃ­a</label>
  </div>
</div>

<div id="paneltransporte" class="subpanel hidden">
  <button class="btnVolverPanel soloIcono" onclick="volverCategorias()">
    <img src="icons/ui/fi-sr-arrow-small-left.svg" alt="Volver">
  </button>
  <h2>ğŸš‰ Transporte</h2>
   <button class="btnBuscarPanel" id="btnBuscarTransporte">ğŸ” Buscar POIs</button>
  <div class="contenedorFiltros">
    <label><input type="checkbox" class="poicheck" data-cat="highway" data-sub="bus_stop"> Parada de bus</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="bus_station"> EstaciÃ³n de bus</label>
    <label><input type="checkbox" class="poicheck" data-cat="railway" data-sub="subway_entrance"> Entrada a metro</label>
    <label><input type="checkbox" class="poicheck" data-cat="railway" data-sub="train_station"> EstaciÃ³n de tren</label>
    <label><input type="checkbox" class="poicheck" data-cat="railway" data-sub="station"> EstaciÃ³n ferroviaria</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="ferry_terminal"> Terminal ferry</label>
    <label><input type="checkbox" class="poicheck" data-cat="aerialway" data-sub="station"> EstaciÃ³n de telefÃ©rico</label>
    <label><input type="checkbox" class="poicheck" data-cat="aeroway" data-sub="airport"> Aeropuerto</label>
    <label><input type="checkbox" class="poicheck" data-cat="aeroway" data-sub="helipad"> Helipuerto</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="parking"> Aparcamiento</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="parking_entrance"> Entrada a parking</label>
    <label><input type="checkbox" class="poicheck" data-cat="railway" data-sub="crossing"> Cruce ferroviario</label>
    <label><input type="checkbox" class="poicheck" data-cat="railway" data-sub="level_crossing"> Paso a nivel</label>
  </div>
</div>
<div id="panelservicios" class="subpanel hidden">
  <button class="btnVolverPanel soloIcono" onclick="volverCategorias()">
    <img src="icons/ui/fi-sr-arrow-small-left.svg" alt="Volver">
  </button>
  <h2>ğŸ› ï¸ Servicios</h2>
    <button class="btnBuscarPanel" id="btnBuscarServicios">ğŸ” Buscar POIs</button>
  <div class="contenedorFiltros">
    <!-- ğŸ›’ Comercio -->
    <label><input type="checkbox" class="poicheck" data-cat="shop" data-sub="supermarket"> Supermercado</label>
    <label><input type="checkbox" class="poicheck" data-cat="shop" data-sub="convenience"> Tienda de conveniencia</label>
    <label><input type="checkbox" class="poicheck" data-cat="shop" data-sub="bakery"> PanaderÃ­a</label>
    <label><input type="checkbox" class="poicheck" data-cat="shop" data-sub="organic"> Tienda ecolÃ³gica</label>
    <label><input type="checkbox" class="poicheck" data-cat="shop" data-sub="butcher"> CarnicerÃ­a</label>
    <label><input type="checkbox" class="poicheck" data-cat="shop" data-sub="sports"> Tienda deportiva</label>
    <label><input type="checkbox" class="poicheck" data-cat="shop" data-sub="bicycle"> Bicicletas</label>
    <label><input type="checkbox" class="poicheck" data-cat="shop" data-sub="books"> LibrerÃ­a</label>
    <label><input type="checkbox" class="poicheck" data-cat="shop" data-sub="chemist"> PerfumerÃ­a / Botica</label>
    <label><input type="checkbox" class="poicheck" data-cat="shop" data-sub="doityourself"> Bricolaje / FerreterÃ­a</label>
    <label><input type="checkbox" class="poicheck" data-cat="shop" data-sub="travel_agency"> Agencia de viajes</label>

    <!-- ğŸ’¸ Finanzas y comunicaciÃ³n -->
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="atm"> Cajero automÃ¡tico</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="bank"> Banco</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="post_office"> Oficina de correos</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="post_box"> BuzÃ³n</label>

    <!-- ğŸ§º Otros -->
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="laundry"> LavanderÃ­a</label>
    <label><input type="checkbox" class="poicheck" data-cat="amenity" data-sub="fuel"> Gasolinera</label>
  </div>
</div>

  </div> <!-- #sidebar -->

  <!-- ğŸ—ºï¸ Mapa principal -->
  <div id="map"></div>

 <div id="panelPoi" class="bottom-sheet hidden">
  <!-- ğŸ“ Grip superior -->
  <div class="grip"></div>

  <!-- ğŸ”˜ BotÃ³n cerrar -->
  <button class="btn-cerrar" id="cerrarPanelPoi" title="Cerrar panel">
    <img src="icons/ui/fi-sr-cross-small.svg" alt="Cerrar" />
  </button>

  <!-- ğŸ”¼ BotÃ³n expandir -->
  <button class="expandir-btn" id="btnExpandirPanel" title="Expandir panel">
    <img src="icons/ui/fi-sr-expand.svg" alt="Expandir" />
  </button>

  <!-- ğŸ“„ Contenido del POI -->
  <div class="contenido-poi">
    <h2 id="poiNombre">POI</h2>
    <div id="poiDatos"></div>
    
    <!-- ğŸ¯ Botones de funciones -->
<div class="acciones-poi">
  <button class="accion-btn" id="btnCompartir" title="Compartir">
    <img src="icons/ui/fi-sr-share.svg" alt="Compartir" />
  </button>
  <button class="accion-btn" id="btnExportar" title="Exportar">
    <img src="icons/ui/fi-sr-download.svg" alt="Exportar" />
  </button>
  <button class="accion-btn" id="btnContribuirPOI" title="Contribuir">
    <img src="icons/ui/fi-sr-attribution-pencil.svg" alt="Contribuir" />
  </button>
  <button class="accion-btn" id="btnVisualizarPOI" title="Ver ubicaciÃ³n">
    <img src="icons/ui/fi-sr-overview.svg" alt="Visualizar POI" />
  </button>
</div>

 <!-- ğŸ“‘ MenÃº compartir -->
<div class="menu-emergente" id="menuCompartir">
  <button onclick="compartirTextoPOI()">
    <img src="icons/ui/fi-sr-blog-text.svg" alt="Texto POI" />
    <span>Compartir como texto</span>
  </button>
  <button onclick="compartirPosicionPOI()">
    <img src="icons/ui/fi-sr-map-marker.svg" alt="UbicaciÃ³n POI" />
    <span>Compartir posiciÃ³n en otra app</span>
  </button>
</div>

<!-- ğŸ“¦ MenÃº exportar -->
<div class="menu-emergente" id="menuExportar">
  <button onclick="exportarPOIIndividual(window.tagsPOI)">
    <img src="icons/ui/fi-sr-clip.svg" alt="Icono exportar POI" />
    <span>Exportar este POI como KML</span>
  </button>
</div>

<!-- ğŸ¤ MenÃº contribuir -->
<div class="menu-emergente" id="menuContribuir">
    <button class="cerrarMenuContribuir" aria-label="Cerrar panel">
  <img src="icons/ui/fi-sr-cross-small.svg" alt="Cerrar" />
</button>
  <div class="guia-osm">
    <p>ğŸ’¡ Â¿QuÃ© puedo aportar aquÃ­?</p>
    <ul>
      <li>ğŸ“ El lugar no tiene nombre o categorÃ­a</li>
      <li>âš ï¸ EstÃ¡ cerrado, abandonado o ya no existe</li>
      <li>ğŸš« Acceso bloqueado o error en ubicaciÃ³n</li>
      <li>âœï¸ Faltan detalles: horario, servicios, tipo</li>
      <li>ğŸ“¸ No aparece en el mapa, pero sÃ­ en la realidad</li>
    </ul>
    <p>
      Tus sugerencias se publican como <strong>nota pÃºblica</strong> en OSM.<br />
      No necesitas cuenta, pero puedes iniciar sesiÃ³n si lo deseas.<br />
      Los editores revisan estas notas para mejorar el mapa ğŸ™Œ
    </p>
  </div>

  <button onclick="abrirEditorOSM()">
    <img src="icons/ui/fi-sr-code-editing.svg" alt="Editor OSM" />
    <span>Editar directamente en OpenStreetMap</span>
  </button>

  <button onclick="aÃ±adirNotaOSM()">
    <img src="icons/ui/fi-sr-blog-pencil.svg" alt="AÃ±adir nota OSM" />
    <span>AÃ±adir sugerencia como nota pÃºblica</span>
  </button>
</div>

<!-- ğŸ—ºï¸ MenÃº ver ubicaciÃ³n -->
<div class="menu-emergente" id="menuVer">
  <button onclick="abrirStreetViewDesdePOI()">
    <img src="icons/ui/fi-sr-street-view.svg" alt="Street View" />
    <span>Ver en Street View</span>
  </button>

  <button onclick="abrirMapillaryDesdePOI()">
    <img src="icons/ui/fi-sr-camera-viewfinder.svg" alt="Mapillary" />
    <span>Ver en Mapillary</span>
  </button>
</div>

  
  <!-- âš™ï¸ Script principal -->
  <script src="script.js" defer></script>
<!--  captura de pantalla -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js')
      .then(() => console.log('Service Worker registrado âœ…'))
      .catch(err => console.error('Error al registrar SW', err));
  }
  </script>
</body>
</html>
